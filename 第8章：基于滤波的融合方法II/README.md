# 第8章：基于滤波的融合方法Ⅱ

## 课程内容

代码、PPT、视频见文件夹

### 课程笔记

#### 编码器运动模型及标定

##### 编码器基础知识

编码器感应轮子的旋转，并在旋转时输出脉冲，脉冲数与转过的角度呈线性比例关系。 

 脉冲对应的是角度增量，有时也用增量除以时间，转成轮子转动的角速度输出。

需要注意的是，编码器只是各种转角测量方式中的一种，其他还有轮速计、霍尔传感器等，本课程以编码器为例子讲解模型，但同样适用于其他形式的传感器。

![pic1](.\PIC\pic1.jpg)

##### 编码器运动模型

![PIC2](.\PIC\PIC2.jpg)

![PIC3](.\PIC\PIC3.jpg)

![PIC4](.\PIC\PIC4.jpg)

![PIC5](.\PIC\PIC5.jpg)

#####  编码器的标定

![pic6](.\PIC\pic6.jpg)

![pic7](.\PIC\pic7.jpg)

![pic7](.\PIC\pic7.jpg)

#### 融合编码器的滤波方法

![pic8](.\PIC\pic8.jpg)

![pic9](.\PIC\pic9.jpg)

![pic10](.\PIC\pic10.jpg)

观测值=预测值减去观测

#### 融合运动约束的滤波方法

![pic11](.\PIC\pic11.jpg)

#### 融合点云特征的滤波方法

建图和定位里面适不适合用融合点云特征的滤波方法？

建图更多是不考虑实时性，所以一般会用优化的方法。但是最近一些研究也开始偏向用滤波的方式提高建图的效率，因为要摆脱地图的依赖。

##### 整体思路

![PIC12](.\PIC\PIC12.jpg)

论文题目：LINS: A Lidar-Inertial State Estimator for Robust and Efficient Navigation 

代码地址：https://github.com/ChaoqinRobotics/LINS---LiDAR-inertial-SLAM

##### 滤波模型

![PIC13](.\PIC\PIC13.jpg)



![PIC14](.\PIC\PIC14.jpg)

知道经纬度我们通过模型可以计算出来重力加速度g，不需要估计。

![PIC15](.\PIC\PIC15.jpg)

![PIC16](.\PIC\PIC16.jpg)

![PIC17](.\PIC\PIC17.jpg)

![PIC18](.\PIC\PIC18.jpg)

##### 相似工作 

代码地址：https://github.com/hku-mars/FAST_LIO 

论文题目：FAST-LIO: A Fast, Robust LiDAR-inertial Odometry Package by Tightly-Coupled Iterated Kalman Filter

## 作业

在上一讲作业里实现的滤波方案的基础上，实现融合运动模型的滤波方法，并对比加入运动模型约束前后，滤波精
度的变化。由于运动模型约束更多的是改善速度的波动，而且是y向和z向的波动，因此要求展示结果时，提供b系y
向和z向速度误差的曲线与指标。
注：同样由于kitti数据集质量的问题，效果的改善不一定在所有路段都能体现，可以挑选效果好的路段重点展示。
评价标准：
1)及格：实现新模型，且功能正常
2)良好：实现新模型，且部分路段性能有改善
3)优秀：在良好的基础上，增加编码器融合的内容，具体如下：
使用仿真数据(仿真数据需要根据下方链接中的仿真程序自己生成)，实现以gps位置和编码器速度为观测量的融合方
法，并分析其精度。

数据仿真程序地址：https://github.com/Aceinna/gnss-ins-sim

#### 附加题(不参与考核)：

编码器参与的融合，还有另外一种融合方式，即编码器不当做观测使用，而是和IMU一起进行状态预测，然后再与
其他传感器提供的观测进行滤波融合。具体思路为IMU提供角速度，编码器提供线速度，假设二者频率相同、时间
戳已对齐，且外参已标定，那么它们可以直接认为是一个可以通过解算得到姿态、位置的新传感器。
这种方式下，解算方法、误差方程、滤波的状态方程和观测方程都需要重新推导，感兴趣的可以自己完成推导和代
码实现，并与之前课程中的方法进行性能对比。


